
### Updated HTML Template
The changes in the HTML template include:
1. Adding a new column for `Confidence` in the table header.
2. Adjusting the column widths to accommodate the new column.
3. Adding a style for the confidence column to make it visually distinct.

```html
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>端到端机构名称匹配综合报告</title>
    <style>
        body { 
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; 
            margin: 0; 
            background-color: #f8f9fa; 
            color: #212529; 
        }
        .container { 
            max-width: 95%; 
            margin: 20px auto; 
            padding: 20px; 
            background-color: #fff; 
            border-radius: 8px; 
            box-shadow: 0 2px 10px rgba(0,0,0,0.1); 
        }
        h1, h2 { 
            color: #0056b3; 
            border-bottom: 2px solid #dee2e6; 
            padding-bottom: 10px; 
        }
        .summary { 
            display: flex; 
            flex-wrap: wrap; 
            justify-content: space-around; 
            margin-bottom: 30px; 
            text-align: center; 
            gap: 15px; 
        }
        .summary-box { 
            padding: 15px; 
            border-radius: 8px; 
            flex-basis: 12%; 
            min-width: 150px; 
            box-shadow: 0 1px 3px rgba(0,0,0,0.05); 
            border-left: 5px solid;
            transition: transform 0.2s ease-in-out;
        }
        .summary-box:hover {
            transform: translateY(-5px);
        }
        .summary-box h3 { 
            margin-top: 0; 
            font-size: 1em; 
            color: #495057; 
        }
        .summary-box .count { 
            font-size: 2em; 
            font-weight: bold; 
        }
        
        .cat-exact { border-color: #228be6; background-color: #e7f5ff; }
        .cat-exact .count { color: #1c7ed6; }
        .cat-judged-consistent { border-color: #2f9e44; background-color: #d3f9d8; }
        .cat-judged-consistent .count { color: #2b8a3e; }
        .cat-judged-inconsistent { border-color: #f59f00; background-color: #fff9db; }
        .cat-judged-inconsistent .count { color: #e67700; }
        .cat-unmatched { border-color: #868686; background-color: #e9ecef; }
        .cat-unmatched .count { color: #495057; }
        
        .controls { margin-bottom: 20px; display: flex; flex-wrap: wrap; gap: 15px; align-items: center; }
        .controls input, .controls select { padding: 8px 12px; border: 1px solid #ced4da; border-radius: 4px; font-size: 1em; }
        .controls input { flex-grow: 1; min-width: 250px; }
        
        table { width: 100%; border-collapse: collapse; font-size: 0.9em; table-layout: fixed; }
        th, td { border: 1px solid #dee2e6; padding: 10px 12px; text-align: left; vertical-align: top; word-break: break-word; }
        thead { background-color: #f1f3f5; position: sticky; top: 0; z-index: 10; }
        th { font-weight: 600; }
        
        .reason-box { margin-top: 10px; border-left: 3px solid; padding: 8px 10px; font-size: 0.9em; border-radius: 3px; }
        .reason-step4 { border-color: #f59f00; background-color: #fff9db; }
        .reason-step5 { border-color: #4c6ef5; background-color: #edf2ff; }
        
        .input-block { padding: 5px; border-radius: 4px; background-color: #f8f9fa; }
        .input-block strong { font-size: 0.9em; color: #495057; }

        .affiliation-block { background-color: #e3f2fd; border-left: 3px solid #2196f3; }
        .pi-site-block { background-color: #e8f5e8; border-left: 3px solid #4caf50; }
        .confidence-block { background-color: #f0f4c3; border-left: 3px solid #c0ca33; text-align: center; }

        .final-decision { font-weight: bold; padding: 5px 8px; border-radius: 4px; display: inline-block; margin-top: 8px; color: white; }
        .exact, .judged-consistent { background-color: #2f9e44; }
        .judged-inconsistent { background-color: #f59f00; }
        .unmatched { background-color: #868686; }
    </style>
</head>
<body>
    <div class="container">
        <h1>端到端机构名称匹配综合报告</h1>
        <p><strong>数据来源:</strong> <code>{{ source_file }}</code></p>
        <p><strong>报告生成时间:</strong> {{ generation_time }}</p>
        
        <h2>AI判断结果概览</h2>
        <div class="summary">
            {% for key, display_name in category_map.items() %}
            <div class="summary-box cat-{{ key }}">
                <h3>{{ display_name }}</h3>
                <div class="count">{{ counts[display_name] }}</div>
            </div>
            {% endfor %}
        </div>

        <h2>详细审核追溯 (共 {{ total_rows }} 条)</h2>
        <div class="controls">
            <select id="filter-select">
                <option value="all">所有最终状态</option>
                {% for key, display_name in category_map.items() %}
                <option value="{{ key }}">{{ display_name }}</option>
                {% endfor %}
            </select>
            <input type="text" id="search-input" placeholder="实时搜索表格内容...">
        </div>
        
        <div style="overflow-x:auto; max-height: 80vh;">
            <table>
                <thead>
                    <tr>
                        <th style="width: 5%;">ID</th>
                        <th style="width: 25%;">原始输入</th>
                        <th style="width: 35%;">匹配过程 & AI理由</th>
                        <th style="width: 10%;">置信度</th>
                        <th style="width: 25%;">最终判断结果</th>
                    </tr>
                </thead>
                <tbody>
                    {{ table_body_html | safe }}
                </tbody>
            </table>
        </div>
    </div>

    <script>
        const searchInput = document.getElementById('search-input');
        const filterSelect = document.getElementById('filter-select');
        const table = document.querySelector('table');
        const rows = table.querySelectorAll('tbody tr');

        function filterAndSearch() {
            const searchTerm = searchInput.value.toLowerCase();
            const filterTerm = filterSelect.value;

            rows.forEach(row => {
                const isVisibleByFilter = filterTerm === 'all' || row.dataset.category === filterTerm;
                const rowText = row.textContent.toLowerCase();
                const isVisibleBySearch = searchTerm === '' || rowText.includes(searchTerm);

                if (isVisibleByFilter && isVisibleBySearch) {
                    row.style.display = '';
                } else {
                    row.style.display = 'none';
                }
            });
        }

        searchInput.addEventListener('keyup', filterAndSearch);
        filterSelect.addEventListener('change', filterAndSearch);
    </script>
</body>
</html>
